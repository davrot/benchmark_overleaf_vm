services:
  mailsink:
    extends:
      file: ./mailsink/compose.yaml
      service: mailsink

  oidc:
    extends:
      file: ./oidc/compose.yaml
      service: oidc

  overleafredis:
    extends:
      file: ./overleafredis/compose.yaml
      service: overleafredis

  overleafmongo:
    extends:
      file: ./overleafmongo/compose.yaml
      service: overleafmongo

  overleafserver:
    extends:
      file: ./overleafserver/compose.yaml
      service: overleafserver
    depends_on:
      overleafredis:
        condition: service_healthy
      overleafmongo:
        condition: service_healthy
      mailsink:
        condition: service_healthy
      oidc:
        condition: service_healthy

  nginx:
    extends:
      file: ./nginx/compose.yaml
      service: nginx
    depends_on:
      overleafserver:
        condition: service_healthy

networks:
  overleaf-network:
    external: true

