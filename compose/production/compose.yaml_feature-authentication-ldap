services:
  mailsink:
    extends:
      file: ./mailsink/compose.yaml
      service: mailsink

  ldap:
    extends:
      file: ./ldap/compose.yaml
      service: ldap

  overleafredis:
    extends:
      file: ./overleafredis/compose.yaml
      service: overleafredis

  overleafmongo:
    extends:
      file: ./overleafmongo/compose.yaml
      service: overleafmongo

  overleafserver:
    extends:
      file: ./overleafserver/compose.yaml
      service: overleafserver
    depends_on:
      overleafredis:
        condition: service_healthy
      overleafmongo:
        condition: service_healthy
      mailsink:
        condition: service_healthy
      ldap:
        condition: service_healthy

  nginx:
    extends:
      file: ./nginx/compose.yaml
      service: nginx
    depends_on:
      overleafserver:
        condition: service_healthy

networks:
  overleaf-network:
    external: true

